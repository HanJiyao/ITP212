<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<f:view>
    <h:body>
        <ui:composition template="/templates/template.xhtml">
            <ui:define name="content">
                <h:form>
                <style type="text/css">
                    @media (max-width: 768px) {
                        .cartHeader{
                            display: none;
                        }
                        .custom-control{
                            padding-left: 0;
                        }
                        .custom-control-label::before {
                            position: inherit;

                        }
                        .custom-control-label::after {
                            position: relative;
                            top: -1.6rem!Important;
                        }
                        .col-md-1{
                            text-align: center!important;
                        }
                    }
                    .custom-control-label::before {
                        width: 1.6rem;
                        height: 1.6rem;
                        top: 0;
                        left: -20px;
                    }
                    .custom-control-label::after {
                        width: 1.6rem;
                        height: 1.6rem;
                        top: 0;
                        left: -20px;
                    }
                    .custom-control-input:checked~.custom-control-label::before {
                        background-color: #FF8800;
                    }
                    .custom-checkbox .custom-control-input:checked~.custom-control-label::before {
                        background-color: #FF8800;
                    }
                    .deleteBtn{
                        color: #4B515D;
                        transition: color 0.3s;
                    }
                    .deleteBtn:hover{
                        color:red;
                    }
                </style>
                <div class="row">
                    <div class="col l8 m12">
                        <div class="card">
                            <div class="row grey-text" style="text-align: center;margin:0;padding-top: 1rem;padding-bottom: 1rem">
                                <div class="col m5">
                                    Food
                                </div>
                                <div class="col m4">
                                    Quantity
                                </div>
                                <div class="col m2">
                                    Price (S$)
                                </div>
                                <div class="col m1">
                                    Del
                                </div>
                            </div>
                            <ui:repeat value="#{cart.getUserCartList(loginView.authenticatedUser.id)}" var="cartItem">
                            <div class="row text-center" style="border-top:solid thin #e0e0e0;margin: 0">
                                <div class="col m5 text-left">
                                    <div class="row">
                                        <div class="col l5">
                                            <h:graphicImage  height="80" width="80" library="food" name="#{cartItem.image}" style="border-radius:100%;margin-top: 1.5rem"/>
                                        </div>
                                        <div class="col l7">
                                            <div style="font-size:1.5rem;margin-top: 1.5rem">
                                                #{cartItem.name}
                                            </div>
                                            <small class="grey-text">#{cartItem.type}</small>
                                            <div>
                                                <small>Unit price: S$ #{cartItem.price}</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col m4" style="text-align: center;font-size: 1.5rem;margin-top: 3rem">
                                    #{cartItem.quantity}
                                    <!--<div class="col">-->
                                        <!--<div class="btn-group number-spinner#{cartItem.id}">-->
                                        <!--<span class="input-prepend data-dwn">-->
                                            <!--<button id="numDown#{cartItem.id}" class="btn red waves-effect" data-dir="dwn" style="border-radius:50%!important;width:36px;height:36px;padding: 0" disabled="disabled">-->
                                                <!--<i class="material-icons" style="vertical-align: -5px;">remove</i>-->
                                            <!--</button>-->
                                        <!--</span>-->
                                            <!--<style>-->
                                                <!--.quantity#{cartItem.id}{-->
                                                    <!--border:none;-->
                                                    <!--outline:none!important;-->
                                                    <!--text-align: center;-->
                                                    <!--font-size: 1.2rem;-->
                                                    <!--width: 100%;-->
                                                    <!--max-width: 50px;-->
                                                <!--}-->
                                            <!--</style>-->
                                            <!--<h:inputText type="text" styleClass="quantity#{cartItem.id}" id="quantity" min="1" max="#{cartItem.quantity}" value="#{cartItem.quantity}"/>-->
                                            <!--<span class="input-append data-up">-->
                                            <!--<button id="numUp#{cartItem.id}" class="btn red waves-effect" data-dir="up" style="border-radius:50%!important;width:36px;height:36px;padding: 0">-->
                                                <!--<i class="material-icons" style="vertical-align: -5px;">add</i>-->
                                            <!--</button>-->
                                        <!--</span>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<script>-->
                                        <!--$(document).ready(function(){-->
                                            <!--var quantity = parseInt("#{cartItem.quantity}")-->
                                            <!--var quantityInput = parseInt($(".quantity#{cartItem.id}").val());-->
                                            <!--if (quantityInput == quantity){-->
                                                <!--$("#numUp#{cartItem.id}").attr("disabled", true);-->
                                            <!--} else {-->
                                                <!--$("#numUp#{cartItem.id}").attr("disabled", false);-->
                                            <!--}-->
                                            <!--if (quantityInput == 1){-->
                                                <!--$("#numDown#{cartItem.id}").attr("disabled", true);-->
                                            <!--} else {-->
                                                <!--$("#numDown#{cartItem.id}").attr("disabled", false);-->
                                            <!--}-->
                                        <!--})-->
                                        <!--$(function () {-->
                                            <!--var quantity = parseInt("#{cartItem.quantity}")-->
                                            <!--$(".number-spinner#{cartItem.id} button").mousedown(function () {-->
                                                <!--btn = $(this);-->
                                                <!--input = btn.closest('.number-spinner#{cartItem.id}').find('input');-->
                                                <!--btn.closest('.number-spinner#{cartItem.id}').find('button').prop("disabled", false);-->
                                                <!--if (btn.attr('data-dir') == 'up') {-->
                                                    <!--if (input.attr('max') == undefined || parseInt(input.val()) &lt; parseInt(input.attr('max'))-1) {-->
                                                        <!--input.val(parseInt(input.val()) + 1);-->
                                                    <!--} else {-->
                                                        <!--input.val(parseInt(input.val()) + 1);-->
                                                        <!--btn.prop("disabled", true);-->
                                                    <!--}-->
                                                <!--} else {-->
                                                    <!--if (input.attr('min') == undefined || parseInt(input.val()) > parseInt(input.attr('min'))+1) {-->
                                                        <!--input.val(parseInt(input.val()) - 1);-->
                                                    <!--} else {-->
                                                        <!--input.val(parseInt(input.val()) - 1);-->
                                                        <!--btn.prop("disabled", true);-->
                                                    <!--}-->
                                                <!--}-->
                                            <!--})-->
                                            <!--$(".quantity#{cartItem.id}").blur(()=>{-->
                                                <!--var quantityInput = parseInt($(".quantity").val());-->
                                                <!--if (quantityInput &lt;= 0 || quantityInput > quantity || !Number.isInteger(parseInt($(".quantity#{cartItem.id}").val().trim()))){-->
                                                    <!--$("#selectErr").click();-->
                                                    <!--$(".quantity#{cartItem.id}").val(1);-->
                                                <!--};-->
                                                <!--if (quantityInput == quantity){-->
                                                    <!--$("#numUp#{cartItem.id}").attr("disabled", true);-->
                                                <!--} else {-->
                                                    <!--$("#numUp#{cartItem.id}").attr("disabled", false);-->
                                                <!--}-->
                                                <!--if (quantityInput == 1){-->
                                                    <!--$("#numDown#{cartItem.id}").attr("disabled", true);-->
                                                <!--} else {-->
                                                    <!--$("#numDown#{cartItem.id}").attr("disabled", false);-->
                                                <!--}-->
                                            <!--})-->
                                        <!--});-->
                                    <!--</script>-->
                                </div>
                                <div class="col m2 text-weight-normal cartPrice" style="font-size:1.5rem;margin-top: 3rem">
                                    #{cartItem.price}
                                </div>
                                <div class="col m1 p-0 text-left" >
                                    <h:commandLink action="#{cart.deleteItem(cartItem.id)}">
                                        <i class="material-icons deleteBtn" style="font-size: 1.8rem; margin-top: 3.2rem">
                                            close
                                        </i>
                                    </h:commandLink>
                                </div>
                            </div>
                            </ui:repeat>
                        </div>
                    </div>
                    <div class="col l4 m12">
                        <div class="cardtext-white" style="padding: 2.5rem">
                            <h4 class="" style="border-bottom:solid thin grey;padding-bottom: 3rem">SUMMARY</h4>
                            <div class="row">
                                <div class="col s5">
                                    <h5 class="">Count</h5>
                                </div>
                                <div class="col s7">
                                    <h5 class="font-weight-normal pt-4" id="cartCount">0</h5>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s5">
                                    <h6 class="">Shipping</h6>
                                </div>
                                <div class="col s7">
                                    <h6 class="font-weight-normal">-</h6>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s5">
                                    <h4 class="pl-4 pt-3 text-weight-normal">Total</h4>
                                </div>
                                <div class="col s7">
                                    <h4 class="font-weight-bold pt-3">$S <span id="cartTotal">0.00</span></h4>
                                </div>
                            </div>
                            <div class="row p-3">
                                <div class="col p-4 mb-4">
                                    <button type="button" class="btn-large waves-effect waves-light red" style="border-radius:10em!important;font-size: 1rem" onclick="checkout()">Proceed Checkout</button>
                                </div>
                            </div>
                            <script type="text/javascript">
                                document.getElementById("cartCount").innerText = document.getElementsByClassName("cartPrice").length
                                var sum = 0;
                                for (i=0;i&lt;document.getElementsByClassName("cartPrice").length;i++){
                                    sum+=parseFloat(document.getElementsByClassName("cartPrice")[i].innerText)
                                }
                                document.getElementById("cartTotal").innerText = sum.toFixed(2);
                            </script>
                        </div>
                    </div>
                </div>
                </h:form>
            </ui:define>
        </ui:composition>
    </h:body>
</f:view>
</html>
