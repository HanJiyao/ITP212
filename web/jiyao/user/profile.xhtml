<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<f:metadata>
    <f:event type="preRenderView" listener="#{reviewController.loadReviews()}"/>
</f:metadata>

<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</h:head>

<h:body>
<ui:composition template="../../templates/template.xhtml">
    <ui:define name="content">
        <style type="text/css">
            .ui-dashboard-column {width:200px;}

            .rev {
                width: 70%
            }

            .titleSize{
                font-size: 120%;
            }

        </style>


        <h:form>
            <h:commandLink action="#{loginView.logout}" value="Logout" />
        </h:form>


            <div class="card" style="margin: 0.9rem">
                <div class="row" style="padding: 2rem">
                        <h3>Hello, #{loginView.authenticatedUser.name}</h3>
                        <p>id: #{loginView.authenticatedUser.email}</p>
                </div>
            </div>

        <div id="container">
                <br/>

                <p:button value="Add Review" action="http://localhost:8080/ITP212/review/add-review-form.xhtml?faces-redirect=true" />

                <br/>

                <div id="calculate">
                    <h:panelGrid columns="3" cellpadding="5" style="width:30%">
                        Average Rating:<p:rating name="header" value="#{reviewController.ratee}" readonly="true" /> #{reviewController.numRate} Users
                    </h:panelGrid>
                </div>



                    <p:tabView>
                    <p:tab title="Review You Posted">
                    <h:panelGrid>
                     <h:form>
<<<<<<< Updated upstream
                    <p:dataTable value="#{reviewController.usersRev(loginView.authenticatedUser.email)}"  var="tempReview" paginator="true" rows="3" widgetVar="tableReview"
=======
                    <p:dataTable value="#{reviewController.usersReviews(loginView.authenticatedUser.email)}"  var="tempReview" paginator="true" rows="3" widgetVar="tableReview"
>>>>>>> Stashed changes
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

                        <f:facet name="header">
                            <p:outputPanel>
                                Search Reviews:
                                <h:inputText value="#{reviewController.theSearchName}" id="theSearchName" />
                            </p:outputPanel>
                        </f:facet>
                        <!--<p:column sortBy="#{tempReview.displayName}">-->
                        <!--&lt;!&ndash; the column header &ndash;&gt;-->
                        <!--<f:facet name="header">-->
                        <!--User-->
                        <!--<h:inputText value="#{reviewController.searchUser}" id="searchUser" />-->
                        <!--</f:facet>-->
                        <!--<h:outputText value="#{tempReview.displayName}" />-->

                        <!--&lt;!&ndash;&lt;!&ndash;  the value for each row &ndash;&gt;&ndash;&gt;-->
                        <!--&lt;!&ndash;#{tempReview.displayName}&ndash;&gt;-->
                        <!--</p:column>-->

                        <p:column headerText="Reviews" sortBy="#{tempReview.reviewText}" styleClass="rev">
                            <f:facet name="header">
                                Reviews
                                <!--<h:inputText value="#{reviewController.theSearchName}" id="theSearchName" />-->
                            </f:facet>

                            <h:outputText styleClass="titleSize" value="#{tempReview.reviewTitle}"/>

                            <br/>

                            <h:outputText value="#{tempReview.reviewText}" />
                            <br/>
                            <span style="font-size: small">
                        Posted at:
                                #{tempReview.reviewDate} | #{tempReview.reviewTime} by #{tempReview.displayName}
                        </span>
                        </p:column>

                        <p:column headerText="Rating" sortBy="#{tempReview.rating}">
                            <!-- the column header -->
                            <!--<f:facet name="header">-->
                            <!--Rating-->
                            <!--</f:facet>-->

                            <!--  the value for each row -->
                            <p:rating value="#{tempReview.rating}" readonly="true" />
                        </p:column>


                        <!--<h:column>-->
                        <!--&lt;!&ndash; the column header &ndash;&gt;-->
                        <!--<f:facet name="header">Rating</f:facet>-->

                        <!--&lt;!&ndash;  the value for each row &ndash;&gt;-->
                        <!--<p:rating value="#{tempReview.date}" readonly="true" />-->
                        <!--</h:column>-->


                        <!--<ui:fragment rendered="#{tempReview.reviewUId == session.reviewUId}">-->
                        <p:column>
                            <!-- column header -->


                            <!-- the value for each row -->
                            <p:commandLink value="Update"
                                           action="#{reviewController.loadReview(tempReview.id)}" />

                            |

                            <p:commandLink value="Delete"
                                           onclick="if (!confirm('Are you sure you want to delete this review?'))return false"
                                           action="#{reviewController.deleteReview(tempReview.id)}" />

                        </p:column>
                        <!--</ui:fragment>-->

                    </p:dataTable>
                    </h:form>
                    </h:panelGrid>
                    </p:tab>
                        <p:tab title="Review You Received">
                            <p>review here</p>
                        </p:tab>
                    </p:tabView>

        </div>
    </ui:define>
</ui:composition>
</h:body>
</html>
